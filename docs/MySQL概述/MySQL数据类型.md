# MySQL 数据类型

MySQL 中定义数据字段的类型对**数据库的优化**是非常重要的。

MySQL 支持多种类型，大致可以分为三类:

* 数值类型
* 日期/时间类型
* 字符串(字符)类型

## 数值类型

* 整数类型 `TINYINT`、`SMALLINT`、`MEDIUMINT`、`INT`、`BIGINT`
* 浮点数类型 `FLOAT`和 `DOUBLE`
* 定点数类型 `DECIMA`

### 整数类型

|类型|占用字节|范围(有符号)|范围(无符号)|
| --- | --- | ---| ---|
|TINYINT| $1$| $-2^7\sim 2^7-1$|$0\sim 2^8-1$|
|SMALLINT|$2$|$-2^{15}\sim 2^{15}-1$|$0\sim 2^{16}-1$|
|MEDIUMINT|$3$|$-2^{23}\sim 2^{23}-1$|$0\sim 2^{24}-1$|
|INT/INTEGER|$4$|$-2^{31}\sim 2^{31}-1$|$0\sim 2^{32}-1$|
|BIGINT|$8$|$-2^{63}\sim 2^{63}-1$|$0\sim 2^{64}-1$|

不同整数类型的主要区别在于**存储空间**和**取值范围**。整数类型可以添加一些可选属性，如：指定显示宽度、指定无符号类型、指定填充位数

#### 指定显示宽度

类型后面加数字，例如INT(3)。但需要注意：INT(3)仅表示显示宽度，**实际存储范围不变**，当**插入数据超过显示宽度时，仍然能够完整显示该数值**

<div style="text-align: center;"><img alt='202403271050909' src='https://cdn.jsdelivr.net/gh/weno861/image/img/202403271050909.png' width=500px> </div>

#### 指定无符号类型

类型后面加上 `unsigned`即可定义无符号类型。当向无符号类型插入负数时将报`out of range`错误

<div style="text-align: center;"><img alt='202403271150203' src='https://cdn.jsdelivr.net/gh/weno861/image/img/202403271150203.png' width=500px> </div>

#### 指定填充位

类型后面加上 `zerofill` 即可定义指定填充物, 指定填充位一般与显示宽度一起使用，当不足位数使用0进行填充(超过指定宽度正常显示)

<div style="text-align: center;"><img alt='202403271153849' src='https://cdn.jsdelivr.net/gh/weno861/image/img/202403271153849.png' width=500px> </div>

!> **在确保取值范围足够的前提下，使用占用空间较小的类型**。但需要注意，千万不要为了节省空间而去选择勉强够用的类型，这样万一今后数据超出范围后导致系统异常的成本远大于多一点存储空间的成本

### 浮点数与定点数类型  

|类型| 字节 |
| ---| ---|
| FLOAT|$4$|
| DOUBLE|$8$|
| DECIMAL/DECIMAL(M,D)|$M>D$,则为$M+2$,否则是$D+2$|

?> `MySQL` 浮点型和定点型可以用类型名称后加`（M，D）`来表示， `M` 表示该值的总共长度， `D` 表示小数点后面的长度， `M` 和 `D` 又称为**精度**和**标度**，如`float(7,4)`的可显示为 $-999.9999$， `MySQL` 保存值时进行四舍五入，如果插入 $999.00009$，则结果为 `999.0001`

!> `float`、`double`和`decimal`的区别

1. `DECIMAL`为定点数类型，实际是以字符串存放的，可能的最大取值范围与`DOUBLE`一样，但有效的取值范围由 `M` 和 `D` 的值决定。设 `D` 不变时， `M` 越大取值范围越大
2. 对浮点数进行减法和比较运算时容易出问题，应尽量避免此类操作
3. `FLOAT`和`DOUBLE`在不指定精度时，默认会按照实际的精度来显示；`DECIMAL`在不指定精度时，默认整数为 $10$，小数为 $0$
4. 对于浮点数和定点数类型，当小数部分超出精度范围时会四舍五入；当整数部分超出范围时会报错

## 字符串类型

| 类型| 存储需求（字节）| 说明|用途|
| ---| ---| ---|---|
| CHAR (M)   | M个字节              | M为0~255之间的整数          | 定长字符串|
| VARCHAR(M) | 存储值的长度+1个字节 | M为0~65535之间的整数        | 变长字符串|
| TINYBLOB   | 存储值的长度+1个字节 | 允许长度0~255字节           | 不超过 255 个字符的二进制字符串|
| BLOB       | 存储值的长度+2个字节 | 允许长度0~65535字节         | 二进制形式的长文本数据|
| MEDIUMBLOB | 存储值的长度+3个字节 | 允许长度0~16777215字节      | 二进制形式的中等长度文本数据 |
| LONGBLOB   | 存储值的长度+4个字节 | 允许长度0~4294967295字节    |二进制形式的极大文本数据|
| TINYTEXT   | 存储值的长度+1个字节 | 允许长度0~255字节           | 短文本字符串|
| TEXT       | 存储值的长度+2个字节 | 允许长度0~65535字节         |长文本数据|
| MEDIUMTEXT | 存储值的长度+3个字节 | 允许长度0~16777215字节      |中等长度文本数据|
| LONGTEXT   | 存储值的长度+4个字节 | 允许长度0~4 294 967 295字节 |  极大文本数据|

!> `char` 和 `varchar` 的区别

1. `CHAR(M)`为**固定长度字符串**，在定义时指定字符串列长。`VARCHAR(M)`是**长度可变的字符串**，M表示最大列长度，占用的空间为字符串的实际长度加1
2. 当检索到`CHAR`值时，尾部的空格将被删除。`VARCHAR`在值保存和检索时尾部的空格仍保留
3. `CHAR`是固定长度，通常**处理速度比`VARCHAR`要快**，缺点是**浪费存储空间**。因此，对存储不大但在速度上有要求的可以使用`CHAR`类型，反之可以使用`VARCHAR`类型来实现

!> `TEXT`与 `BLOB` 的区别

1. `BLOB`列存储的是**二进制字符串**（字节字符串），`TEXT`列存储的是**非二进制字符串**（字符字符串）
2. `BLOB`列没有字符集，排序和比较基于**列值字节的数值**；`TEXT`列有一个字符集，根据**字符集对值进行排序和比较**
3. `BLOB`主要存储图片、音频信息等，而`TEXT`只能存储纯文本文件

## 日期和时间类型

|类型|字节| 范围 | 格式  |用途|
| :---| :---| :---| :---| :---: |
| DATE      | 3             | 1000-01-01/9999-12-31                                        | YYYY-MM-DD          |          日期值          |
| TIME      | 3             | '-838:59:59'/'838:59:59'                                     | HH:MM:SS            |     时间值或持续时间     |
| YEAR      | 1             | 1901/2155                                                    | YYYY                |          年份值          |
| DATETIME  | 8             | '1000-01-01 00:00:00' 到 '9999-12-31 23:59:59'               | YYYY-MM-DD hh:mm:ss |     混合日期和时间值     |
| TIMESTAMP | 4             | '1970-01-01 00:00:01' UTC 到 '2038-01-19 03:14:07' UTC结束时间是第 **2147483647** 秒，北京时间 **2038-1-19 11:14:07**，格林尼治时间 2038年1月19日 凌晨 03:14:07 | YYYY-MM-DD hh:mm:ss | 混合日期和时间值，时间戳 |

!> `DATETIME`和 `TIMESTAMP` 区别

1. `TIMESTAMP` 值的存储是以UTC（世界标准时间）格式保存的，存储时对当前时区进行转换，检索时再转换回当前。`DATETIME`只存储实际输入日期值
2. 两个日期比较大小或日期计算时，`TIMESTAMP`更方便、更快
3. 在实际开发工作中使用的大多数类型是`DATETIME`，由于其表示日期时间信息完整且取值范围大，一般优先选择。但是对于涉及日期/时间计算的场景，可以选择 `TIMESTAMP`

## 枚举类型和集合类型

* 枚举类型`ENUM`的值是以列表形式显示，多个值之间以逗号来分隔
  * 插入值时**只允许从一个集合中取得某一个值**，保存时并不保存它的值，每个值都有一个区号，保存的也是这个区号
  <div style="text-align: center;"><img alt='202403271242252' src='https://cdn.jsdelivr.net/gh/weno861/image/img/202403271242252.png' width=500px> </div>
* 集合类型 `SET` 是一个字符串对象，可以有零或多个值，其值来自表创建时规定的允许的一列值
  * 插入多个数据时，用逗号分隔
  <div style="text-align: center;"><img alt='202403271248640' src='https://cdn.jsdelivr.net/gh/weno861/image/img/202403271248640.png' width=500px> </div>
